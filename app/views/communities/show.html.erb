  <div class="community-info">
    <%= render 'communities/info', community: @community, currentUser: @currentUser %>
  </div>

  <div class="community-main">
    <p class="page-title"><%= @community.community_name %>のダッシュボード</p>
    <div class="community-dashboard round">
        <!-- ルールの棒グラフ一覧表示（ジャンル別）-->
        <!-- コミュニティ健全度の表示(定義説明あり) -->
      <section class="community-dashboard-section">
        <p class="community-dashboard-section-title">ルールの数</p>
        <p class="community-dashboard-section-content">
          <% if @community.rules.present? %>
            <%= @community.rules.count %>
          <% else %>
            0
          <% end %>
        </p>
      </section class="community-dashboard-section">
      <section class="community-dashboard-section">
        <p class="community-dashboard-section-title">報酬の数</p>
        <p class="community-dashboard-section-content">
          <% if @community.privileges.present? %>
            <%= @community.privileges.count %>
          <% else %>
            0
          <% end %>
        </p>
      </section>
      <section class="community-dashboard-section">
        <p class="community-dashboard-section-title">ペナルティの数</p>
        <p class="community-dashboard-section-content">
          <% if @community.penalties.present? %>
            <%= @community.penalties.count %>
          <% else %>
            0
          <% end %>
        </p>
      </section>
      <section class="community-dashboard-section">
        <p class="community-dashboard-section-title">今月のルール実行回数</p>
        <p class="community-dashboard-section-content">
          <% if @excutedRules.present? %>
            <%= @excutedRules.count %>
          <% else %>
            0
          <% end %>
        </p>
      </section>
      <section class="community-dashboard-section">
        <p class="community-dashboard-section-title">メンバーの人数<p>
        <p class="community-dashboard-section-content"><%= @community.users.count %></p>
      </section>
        <!-- メンバーアイコンで表示(リンク有※メンバーの一覧ページ) -->
    </div>
    <div class="community-users round">
      <p class="section-title">メンバー</p>
      <div class="community-user-list">
      <% @community.users.each do |user| %>
        <div class="community-user">
          <div class="profile_image"><%= attachment_image_tag user, :profile_image, :fill, 80, 80, format: 'jpeg', fallback: "f_f_event_98_s512_f_event_98_0bg.jpg", size:'80x80'%></div>
          <p class="community-user-name"><b><%= user.name %></b></p>
        </div>
      <% end %>
      </div>
    </div>
    <div class="goals round">
      <div class="goal-header">
        <p class="section-title">ゴール</p>
        <% if @goal.present? %>
          <p><%= link_to "ゴール編集", edit_community_goal_path(@community.id) %></p>
        <% else %>
          <p><%= link_to "ゴール作成", new_community_goal_path(@community.id) %></p>
        <% end %>
      </div>
      <div class="goal-show">
        <% if @goal.present? %>
          <div class="goal-content">
            <p class="goal-content-letters"><%= @goal.content %></p>
            <div class="goal-content-background-line"></div>
          </div>
          <div class="till-goal">
            <p class="till-goal-letters">ゴール達成まで残り</p>
          </div>
          <div class="goal-deadline">
            <p class="goal-deadline-timer" id="countTimer"></p>
          </div>
        <% else %>
          <div>
            <p>コミュニティのメンバー全員で目指す目標を決めましょう！</p>
          </div>
        <% end %>
      </div>
    </div>
    <div class="mottos round">
      <div class="mottos-header">
        <p class="section-title">スローガン</p>
        <p><%= link_to "スローガン編集", community_mottos_path(@community.id) %></p>
      </div>
      <% if @mottos.present? %>
        <div class="mottos-show">
        <% @mottos.each.with_index(1) do |motto, index| %>
          <div class="motto-index">
            <p class="motto-index-number"><b><%= index %></b></p>
          </div>
          <div class="motto-content">
            <p class="motto-content-letters"><%= motto.content %></p>
            <div class="mottos-content-background-line"></div>
          </div>
        <% end %>
        </div>
      <% else %>
        <p>このコミュニティにはまだスローガンがありません。</p>
      <% end %>
      </div>
    <div class="rules round">
      <div class="rules-header">
        <p class="section-title">ルール</p>
        <p><%= link_to "ルール編集", community_rules_path(@community.id) %></p>
      </div>
      <% if @rules.present? %>
      <div class="community-rules-in-dashboard">
        <% @rules.each do |rule| %>
        <div class="community-rule-box">
          <div class="community-rule-box-genre"><%= rule.genre %></div>
          <div class="community-rule-box-content"><%= rule.content %></div>
          <div class="community-rule-box-point"><%= rule.point %><span class="point-letter">ポイント</span></div>
          <div class="community-rule-box-cta"><%= link_to "実行", community_rule_execute_path(@community.id, rule.id), class: "rule-execute-btn" %></div>
        </div>
        <% end %>
      <% else %>
        <p>このコミュニティにはまだルールがありません。</p>
      <% end %>
      </div>
    </div>
    <div class="late-actibities round">
      <div class="late-activities-header">
        <p class="section-title">直近10件の活動履歴</p>
        <p><%= link_to "過去30日の活動履歴", community_records_path(@community.id) %></p>
      </div>
    </div>
  </div>
  <!-- 以下、カウントダウン表示のためのJavaScript -->
  <script>
    // タイマーの日付を設定
    var countDownDate = new Date(gon.deadline).getTime();
    // 1秒おきに更新
    var x = setInterval(function() {
      // 今日の日付と時間を取得
      var now = new Date().getTime();
      // 日付と時間の計算
      var distance = countDownDate - now;
      var days = Math.floor(distance / (1000 * 60 * 60 * 24));
      var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
      var seconds = Math.floor((distance % (1000 * 60)) / 1000);
      // 出力する内容
      document.getElementById("countTimer").innerHTML = days + "<span>日</span>" + hours + "<span>時間</span>" + minutes + "<span>分</span>" + seconds + "<span>秒</span>";
      // タイマー終了後
      if (distance < 0) {
        clearInterval(x);
        document.getElementById("countTimer").innerHTML = "タイマーが終わったよ。目標は達成できましたか？";
      }
    }, 1000);
  </script>